# AMLL TTML DB RAW DATA

ä¸º[amll-ttml-db](https://github.com/Steve-xmh/amll-ttml-db)æäº¤AMLLæ­Œè¯ä½¿ç”¨çš„å­˜å‚¨åº“ã€‚

## ass2ttml.lua

<a href="https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/ass2ttml-3.2.lua"><img src="https://img.shields.io/badge/Aegisub-3.2-c21f30"/></a> <a href="https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/ass2ttml-3.4.lua"><img src="https://img.shields.io/badge/Aegisub-3.4-c21f30"/></a> <a href="https://aegi.vmoe.info/docs/3.2/Automation/Lua/"><img src="https://img.shields.io/badge/Aegisub-Lua-000080"/></a> <a href="https://help.apple.com/itc/videoaudioassetguide/#/itc0f14fecdd"><img src="https://img.shields.io/badge/Apple_Music-TTML-1ba784"/></a>

> [!NOTE]
>
> ç”¨äºåœ¨ Aegisub åº”ç”¨å†…å°† ass å­—å¹•æ–‡ä»¶ç›´æ¥å¯¼å‡ºå¯ç”¨ ttml æ–‡ä»¶çš„è‡ªåŠ¨åŒ–è„šæœ¬ã€‚
>
> *ttml è½¬ ass æˆ–å…¶å®ƒæ ¼å¼æˆ³è¿™é‡Œ => [ranhengzhang/ttml-translater](https://github.com/ranhengzhang/ttml-translater)*

### å¦‚ä½•å®‰è£…

1. ä¸‹è½½å¥½ lua è„šæœ¬åï¼Œæ‰“å¼€è‡ªåŠ¨åŒ–é¡µé¢
    ![image-20250405150127083](./img/README/image-20250405150127083.png)
2. éšä¾¿é€‰æ‹©ä¸€ä¸ªè„šæœ¬ï¼Œç‚¹å‡»ã€Œæ˜¾ç¤ºä¿¡æ¯ã€
    ![image-20250405150322099](./img/README/image-20250405150322099.png)
3. åœ¨æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€æ˜¾ç¤ºçš„å®Œæ•´è·¯å¾„ï¼ˆ**åªéœ€è¦æ‰“å¼€åˆ°ã€Œautoloadã€ç›®å½•**ï¼‰
    ![image-20250405150402724](./img/README/image-20250405150402724.png)
4. å°† lua è„šæœ¬æ”¾å…¥ã€Œautoloadã€ç›®å½•ä¸­ï¼Œé‡æ–°æ‰“å¼€ Aegisub å³å¯åœ¨è‡ªåŠ¨åŒ–åˆ—è¡¨ä¸­çœ‹è§
    ![image-20250405150733629](./img/README/image-20250405150733629.png)
    ![image-20250405150800825](./img/README/image-20250405150800825.png)

### å¦‚ä½•ä½¿ç”¨

è¯¥è‡ªåŠ¨åŒ–è„šæœ¬éœ€è¦æŒ‰ç…§ç‰¹å®šæ ¼å¼å’Œæ ‡è®°å¯¼å‡ºæ­£ç¡® ttml å†…å®¹

#### æ ‡è®°è¡Œç±»å‹

è¯¥è„šæœ¬ä¸ä¼šåŒºåˆ† Dialog è¡Œå’Œ Comment è¡Œï¼Œå¹¶ä¸”åªä¼šå¤„ç†ã€Œæ ·å¼ã€ä¸º `orig` `ts` `roma` åŒæ—¶ã€Œç‰¹æ•ˆã€ä¸º**ç©º**æˆ–ã€Œ**karaoke**ã€çš„éƒ¨åˆ†

![image-20250405151712938](./img/README/image-20250405151712938.png)

å…¶ä¸­ï¼Œ`orig` è¡¨ç¤ºåŸæ–‡è¡Œï¼Œ`ts` è¡¨ç¤ºç¿»è¯‘è¡Œï¼Œ`roma` è¡¨ç¤ºéŸ³è¯‘è¡Œã€‚æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œåœ¨æ‰“è½´æ—¶ï¼Œå¯¹äºä¸€äº›ä¸å¸Œæœ›å†™å…¥ ttml ä¸­ä½†æ˜¯åˆæƒ³ä¿ç•™çš„è¡Œï¼ˆä¾‹å¦‚æ­Œæ›²ä¿¡æ¯ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä¸ä¼šå¤„ç†çš„æ ‡ç­¾è¿›è¡Œæ ‡è®°

![image-20250405152851380](./img/README/image-20250405152851380.png)

#### æ ‡è®°è¡Œè§’è‰²

åœ¨ ttml ä¸­å¯ä»¥å°†è¡Œæ ‡è®°ä¸º**å¯¹å”±**ã€**èƒŒæ™¯å£°**ä¸**ç¿»è¯‘è¯­è¨€**ï¼Œåœ¨ ass å­—å¹•ä¸­å¯ä»¥åœ¨è¯´è¯äººä¸€æ å¡«å†™ç›¸åº”æ ‡è®°è¿›è¡Œè®¾ç½®ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

- `x-bg`ï¼šèƒŒæ™¯å£°è¡Œ
- `x-duet` æˆ– `x-anti`ï¼šå¯¹å”±è¡Œ
- `x-chor`ï¼šåˆå”±è¡Œ
- `x-mark*`ï¼šç”¨äºç‰¹å®šæ ‡è®°ï¼Œä½†ä¸è¾“å‡ºåˆ° ttml æ–‡ä»¶ä¸­
- `x-lang:*`ï¼šç”¨äºåœ¨ ts è¡Œä¸­æ ‡è®°ç¿»è¯‘å¯¹åº”çš„è¯­è¨€ã€‚**(é»˜è®¤ä¸º `zh-CN`)**
- `x-part:*`ï¼šç”¨äºæ ‡è®°æ–°çš„éƒ¨åˆ†çš„å¼€å§‹

![image-20250405153536928](./img/README/image-20250405153536928.png)

> **åˆå”±è¡Œçš„å¤„ç†**
>
> å½“ä¸Šä¸‹ä¸¤è¡Œæ—¶é—´è½´ç›¸åŒä½†æ˜¯ role ä¸åŒæ—¶ï¼Œä½¿ç”¨åˆå”±è¡Œè¿›è¡Œæ ‡è®°ã€‚è¾“å‡ºæ—¶ä¼šè‡ªåŠ¨è¾“å‡ºä¸¤è¡Œã€‚
>
> ä»¥ä¸‹æ˜¯ä½¿ç”¨ x-chor è¿›è¡Œæ ‡è®°çš„ä¾‹å­ï¼š
>
> ![image-20250728202430532](./img/README/image-20250728202430532.png)
>
> ä½¿ç”¨è„šæœ¬å¯¼å‡ºä¸º ttml åï¼Œè¢«æ ‡è®°ä¸ºåˆå”±çš„éƒ¨åˆ†æ ¼å¼åŒ–ä¹‹åä¸ºï¼š
>
> ```xml
> <p begin="01:22.780" end="01:30.600" ttm:agent="v1" itunes:key="L10">
>     <span begin="01:22.780" end="01:23.860">è®©</span>
>     <span begin="01:23.860" end="01:24.710">æˆ‘</span>
>     <span begin="01:24.710" end="01:25.010">æœ€</span>
>     <span begin="01:25.010" end="01:25.540">å</span>
>     <span begin="01:25.540" end="01:25.920">ä¸€</span>
>     <span begin="01:25.920" end="01:26.240">æ¬¡</span>
>     <span begin="01:26.240" end="01:27.760">æƒ³</span>
>     <span begin="01:27.760" end="01:30.600">ä½ </span>
> </p>
> <p begin="01:22.780" end="01:30.600" ttm:agent="v2" itunes:key="L11">
>     <span begin="01:22.780" end="01:23.860">è®©</span>
>     <span begin="01:23.860" end="01:24.710">æˆ‘</span>
>     <span begin="01:24.710" end="01:25.010">æœ€</span>
>     <span begin="01:25.010" end="01:25.540">å</span>
>     <span begin="01:25.540" end="01:25.920">ä¸€</span>
>     <span begin="01:25.920" end="01:26.240">æ¬¡</span>
>     <span begin="01:26.240" end="01:27.760">æƒ³</span>
>     <span begin="01:27.760" end="01:30.600">ä½ </span>
> </p>
> ```
>
> 

> **å…³äºå¤šè¯­è¨€ç¿»è¯‘**
>
> ä»¥ MARiA çš„ã€Šæ™ºå­ã€‹ä¸ºä¾‹ï¼Œè¿™é¦–**ä¸­æ–‡**æ­Œåœ¨å®˜æ–¹ MV ä¸­ç»™å‡ºäº†**è‹±æ–‡å’Œæ—¥æ–‡**çš„ç¿»è¯‘ï¼Œå› æ­¤åœ¨ ass æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ ‡è®°ä¸¤ä¸ª ts è¡Œã€‚è€Œä¸ºäº†åŒºåˆ†è¿™ä¸¤ç§è¯­è¨€ï¼Œå°±éœ€è¦ä½¿ç”¨ `x-lang` æ ‡è®°æŒ‡åç¿»è¯‘è¯­è¨€ã€‚
>
> æ ¼å¼ä¸º `x-lang:<languagecode>-<regioncode>`ï¼Œå…·ä½“æœ‰å“ªäº›ç±»å‹ä»¥ amll player å¼€å‘è€…æœªæ¥ç»™å‡ºçš„ä¸ºå‡†ï¼Œç›®å‰æš‚æ—¶éµå¾ª **RFC 1766** æ ‡å‡†ã€‚
>
> - **è¯­è¨€ä»£ç ** (ISO 639-1ï¼‰ï¼šä¸¤ä¸ªå°å†™å­—æ¯ (å¦‚ `zh` è¡¨ç¤ºä¸­æ–‡ï¼Œ`en` è¡¨ç¤ºè‹±è¯­)
> - **åœ°åŒºä»£ç ** (ISO 3166-1ï¼‰ï¼šä¸¤ä¸ªå¤§å†™å­—æ¯ (å¦‚ `CN` è¡¨ç¤ºä¸­å›½ï¼Œ`US` è¡¨ç¤ºç¾å›½)
>
> ä»¥ä¸‹æ˜¯ä½¿ç”¨ `x-lang` æ ‡è®°ä¸¤ç§ä¸åŒè¯­è¨€ç¿»è¯‘çš„ä¾‹å­ï¼š
>
> ![image-20250423194046711](./img/README/image-20250423194046711.png)

> **å…³äº `x-mark`**
>
> è¿™ä¸ªæ ‡è®°ä¸€èˆ¬ç”¨äºç»Ÿè®¡ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œè­¬å¦‚åœ¨ ttml è¾“å‡ºå®Œæˆåï¼Œæˆ‘éœ€è¦æ£€æŸ¥ä¸€äº›è¡Œçš„è¾“å‡ºæƒ…å†µï¼Œåˆ™å¯ä»¥ä¸ºè¿™äº›è¡Œæ‰“ä¸Š `x-mark` æ ‡è®°ã€‚
>
> ä»¥ä¸‹æ˜¯ä½¿ç”¨ `x-mark` æ ‡è®°**ä½¿ç”¨äº†éœ€è¦å£°æ˜ç¿»è¯‘æ¥æº**çš„è¡Œçš„ä¾‹å­ï¼š
>
> ![image-20250405153840066](./img/README/image-20250405153840066.png)
>
> ![image-20250405153859390](./img/README/image-20250405153859390.png)
>
> `x-mark` æ ‡è®°ä¼šæ ¹æ®åç¼€ä¸åŒè¿›è¡Œåˆ†ç»„ï¼Œè­¬å¦‚å…¶ä¸­ä¸€äº›è¡Œæ ‡è®°äº† `x-mark-a`ï¼Œå¦ä¸€äº›æ ‡è®°äº† `x-mark-b`ï¼Œé‚£ä¹ˆåœ¨æœ€ç»ˆç»Ÿè®¡ä¸­ä¼šåˆ†åˆ«è¿›è¡Œè¾“å‡ºã€‚

> **å…³äº songPart**
>
> å»ºè®®ä¾ç…§ Apple Music çš„å»ºè®®è¿›è¡Œæ ‡è®°ï¼š
>
> - Verseï¼ˆä¸»æ­Œï¼‰
> - Chorusï¼ˆå‰¯æ­Œï¼‰
> - PreChorusï¼ˆé¢„å‰¯æ­Œï¼‰
> - Bridgeï¼ˆæ¡¥æ®µï¼‰
> - Introï¼ˆå‰å¥ï¼‰
> - Outroï¼ˆå°¾å¥ï¼‰
> - Refrainï¼ˆå å¥ï¼‰
> - Instrumentalï¼ˆå™¨ä¹ï¼‰
>
> å¯ä»¥ä½¿ç”¨ [set-part.lua](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/set-part.lua) è„šæœ¬å¿«é€Ÿè®¾ç½®ã€‚

#### æ ‡è®°éŸ³èŠ‚ç±»å‹

ass2ttml è„šæœ¬ä½¿ç”¨å†…è”æ ‡è®°ï¼ˆ[inline-fx](https://aegi.vmoe.info/docs/3.2/Karaoke_inline-fx/)ï¼‰è¿›è¡Œå•éŸ³èŠ‚çš„ç‰¹æ®Šå¤„ç†ï¼Œç›®å‰æ”¯æŒä»¥ä¸‹æ ‡è®°ï¼š

- åˆå¹¶æ ‡è®°ï¼š`{\-M}` æˆ– `{\-merge}`ï¼Œè¡¨ç¤ºä¸å‰ä¸€ä¸ª**æœ‰å†…å®¹çš„**éŸ³èŠ‚åˆå¹¶ï¼ˆä¼šå°†å¤¹åœ¨ä¸­é—´çš„ç©ºæ ¼ä¹Ÿåˆå¹¶ï¼‰ã€‚å¸¸ç”¨äºåœ¨æ—¥è¯­ä¸­ï¼Œå‰ä¸€ä¸ªæ±‰å­—åªå‘ä¸€ä¸ªéŸ³ï¼Œå¹¶ä¸”å’Œåé¢ä¸€ä¸ªå­—/å‡åè¿è¯»

  > **æ ·ä¾‹**
  >
  > ```ass
  > {\ko19}ä½•|<ãª{\ko8}#|ã‚“{\ko22}åº¦|<ã©{\ko24}ã§{\ko44}ã‚‚{\ko27}{\ko12}ç”Ÿ|<ã†{\ko13}ã¾{\ko22}ã‚Œ{\ko22}å¤‰|<ã‹{\ko23}ã‚{\ko38}ã£{\ko12}{\ko35}ã¦{\ko12} {\ko7}ã‚{\ko8}ã®{\ko32}æ—¥|<ã²{\ko26}ã®{\ko18}{\ko16}å›|<ã{\ko36}#|ã¿{\ko23}ã«{\ko21}{\ko24}é€¢|<ã‚{\ko46}ã„{\ko18}ã«{\ko23}{\-M}è¡Œ|<ã„{\ko47}ã{\ko252}ã‚ˆ
  > ```
  >
  > `{\ko18}ã«{\ko23}è¡Œ|<ã„` éƒ¨åˆ†å˜ä¸ºé•¿éŸ³ï¼Œä½†æ˜¯å¦‚æœæ ‡è®°ä¸º `{\ko41}ã«è¡Œ|<ã„` åˆ™ä¼šåœ¨åº”ç”¨æ¨¡æ¿åå¯¼è‡´ furi è¡Œé”™ä½ï¼ˆã€Œã«<ruby>è¡Œ<rt>ã„</rt></ruby>ã€å˜ä¸ºã€Œ<ruby>ã«è¡Œ<rt>ã„</rt></ruby>ã€ï¼‰ï¼Œå› æ­¤ä½¿ç”¨åˆå¹¶æ ‡è®° `{\ko18}ã«{\ko23\-M}è¡Œ|<ã„`ï¼Œä½¿ç”¨è„šæœ¬å¯¼å‡ºåçš„ç»“æœä¸ºï¼š
  >
  > ```xml
  > <span begin="03:49.320" end="03:49.730">ã«è¡Œ</span>
  > ```

- çº¯æ–‡æœ¬èŠ‚ç‚¹æ ‡è®°ï¼š`{\-T}` æˆ– `{\-text}`ï¼Œè¡¨ç¤ºå¯¼å‡ºä¸ºçº¯æ–‡æœ¬èŠ‚ç‚¹

  > **æ ·ä¾‹**
  >
  > ```ass
  > {\ko21}åƒ•|<ã¼{\ko50}#|ã{\ko22}ã‚‰{\ko27}ã‹{\ko46}ã‚‰{\ko25}{\ko27}ãƒ—{\ko43}ãƒ¬{\ko33}ã‚¼{\ko18}ãƒ³{\ko92}ãƒˆ {\ko197}ãƒ•ã‚©ãƒ¼{\ko0}ãƒ»{\ko75}ãƒ¦ãƒ¼{\ko0}{\T}ğŸ’€
  > ```
  >
  > ä¸“è¾‘æ­Œè¯æœ¬ä¸­ï¼Œæ­¤è¡Œæ­Œè¯çš„æœ«å°¾é™„ä¸Šäº†ä¸€ä¸ª Emojiï¼Œä½†æ˜¯è¿™ä¸ª Emoji å¹¶ä¸å ç”¨ä»»ä½•è¡Œæ—¶é—´ï¼Œå¹¶ä¸”ä¸å¥½åº”ç”¨é€å­—æ¸å˜ï¼Œåˆ™ä½¿ç”¨çº¯æ–‡æœ¬æ ‡è®°ä½¿å…¶å¸¸äº®ï¼Œè¯¥è¡Œå¯¼å‡ºç»“æœä¸ºï¼š
  >
  > ```xml
  > <p begin="03:47.480" end="03:54.240" ttm:agent="v1" itunes:key="L50"><span begin="03:47.480" end="03:48.190">åƒ•</span><span begin="03:48.190" end="03:48.410">ã‚‰</span><span begin="03:48.410" end="03:48.680">ã‹</span><span begin="03:48.680" end="03:49.140">ã‚‰</span><span begin="03:49.390" end="03:49.660">ãƒ—</span><span begin="03:49.660" end="03:50.090">ãƒ¬</span><span begin="03:50.090" end="03:50.420">ã‚¼</span><span begin="03:50.420" end="03:50.600">ãƒ³</span><span begin="03:50.600" end="03:51.520">ãƒˆ</span><span begin="03:51.520" end="03:51.520"> </span><span begin="03:51.520" end="03:53.490">ãƒ•ã‚©ãƒ¼ãƒ»</span><span begin="03:53.490" end="03:54.240">ãƒ¦ãƒ¼</span>ğŸ’€<span ttm:role="x-roman">bo ku ra ka ra present for you</span><span ttm:role="x-translation" xml:lang="zh-CN">æˆ‘ä»¬çŒ®ä¸Šè¿™ä»½èµ ç¤¼ ä¸“å±äºä½ </span></p>
  > ```

- é›¶æ—¶é—´èŠ‚ç‚¹æ ‡è®°ï¼š`{\-Z}` æˆ– `{\-zero}`ï¼Œè¡¨ç¤ºç›®æ ‡åœ¨å¯¼å‡ºæ—¶æŒç»­æ—¶é—´åº”ä¸º 0ï¼ˆ*ä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œæ’ä»¶åœ¨å¯¼å‡ºæ—¶ä¼šå°†æ‰€æœ‰æŒç»­æ—¶é—´ä¸º 0 å¹¶ä¸”ä¸ä¼šåˆå¹¶çš„éæ–‡æœ¬èŠ‚ç‚¹æŒç»­æ—¶é—´è®¾ç½®ä¸º 5 ms*ï¼‰

  > **æ ·ä¾‹**
  >
  > ```ass
  > {\kf0}â€œ{\kf20}ç¡{\kf6}ä¸{\kf21}ç€{\kf22}å—{\kf141\-Z}ï¼Ÿ{\kf10}æ²¡{\kf17}å…³{\kf29}ç³»{\kf99}{\-Z}ï¼Œ{\kf11}å› {\kf42}ä¸º{\kf0}â€
  > ```
  >
  > è¿™é‡Œçš„ã€Œï¼Ÿã€å’Œã€Œï¼Œã€å¦‚æœåŸæ ·å¯¼å‡ºçš„è¯ä¼šè§¦å‘é«˜äº®ï¼Œå› æ­¤ä½¿ç”¨é›¶æ—¶é—´æ ‡è®°ï¼Œå¯¼å‡ºç»“æœå¦‚ä¸‹ï¼š
  >
  > ```xml
  > <p begin="01:43.080" end="01:47.260" ttm:agent="v1" itunes:key="L29"><span begin="01:43.080" end="01:43.280">â€œç¡</span><span begin="01:43.280" end="01:43.340">ä¸</span><span begin="01:43.340" end="01:43.550">ç€</span><span begin="01:43.550" end="01:43.770">å—</span><span begin="01:43.770" end="01:43.775">ï¼Ÿ</span><span begin="01:45.180" end="01:45.280">æ²¡</span><span begin="01:45.280" end="01:45.450">å…³</span><span begin="01:45.450" end="01:45.740">ç³»</span><span begin="01:45.740" end="01:45.745">ï¼Œ</span><span begin="01:46.730" end="01:46.840">å› </span><span begin="01:46.840" end="01:47.260">ä¸ºâ€</span></p>
  > ```

#### è¾“å‡ºä¸º TTML

##### è¾“å‡ºä¹‹å‰

åœ¨è¾“å‡ºä¹‹å‰ï¼Œéœ€è¦å°†è¡Œè¿›è¡Œä¸€æ¬¡æ’åºï¼Œæ‰èƒ½è¿›è¡Œæ­£å¸¸çš„è¾“å‡ºï¼Œå¯ä»¥ä½¿ç”¨ Aegisub è‡ªå¸¦çš„è¡Œæ’åºè¿›è¡Œæ“ä½œã€‚å…·ä½“ä¸º â‘ æ ·å¼åç§° â‘¡è¯´è¯äºº â‘¢å¼€å§‹æ—¶é—´ã€‚ï¼ˆæœ‰æ—¶å¯èƒ½è¿˜éœ€è¦é€‰ä¸­ç‰¹æ®Šçš„éƒ¨åˆ†æŒ‰ç»“æŸæ—¶é—´æ’åºï¼‰

![image-20250405154346351](./img/README/image-20250405154346351.png)

å¯¹äºæ—¥è¯­æ¥è¯´ï¼Œæœ€å¥½ç”¨ [fix-furi.lua](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/fix-furi.lua) è„šæœ¬å¤„ç†ä¸€æ¬¡ï¼Œå°†æ³¨éŸ³æ–­æ‰çš„éƒ¨åˆ†è¡”æ¥ã€‚å¹¶ä¸”ä½¿ç”¨ [check.ass](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/check.ass) ä¸­çš„æ¨¡æ¿è¡Œè¿›è¡Œä¸€æ¬¡æ ¸éªŒã€‚

> **å¤„ç†å‰**
>
> ```ass
> {\ko13}åƒ•|<ã¼{\ko8}{\ko24}#|ã{\ko15}ã‚‰{\ko26}ã¯{\ko7}{\ko19}ã“ã‚“{\ko29}ãª{\ko11}ã“{\ko23}ã¨{\ko12}ã—{\ko11}ãŸ{\ko26}ã‹{\ko12}ã£{\ko22}ãŸ{\ko17}ã®{\ko30}ã‹{\ko67}ãª
> ```
>
> **å¤„ç†å**
>
> ```ass
> {\ko13}åƒ•|<ã¼{\ko8}#|{\ko24}#|ã{\ko15}ã‚‰{\ko26}ã¯{\ko7}{\ko19}ã“ã‚“{\ko29}ãª{\ko11}ã“{\ko23}ã¨{\ko12}ã—{\ko11}ãŸ{\ko26}ã‹{\ko12}ã£{\ko22}ãŸ{\ko17}ã®{\ko30}ã‹{\ko67}ãª
> ```

##### å¡«å†™æ ‡ç­¾

ç‚¹å‡»è‡ªåŠ¨åŒ–è„šæœ¬è¿›å…¥å¯¼å‡ºé¡µé¢

![image-20250405154456199](./img/README/image-20250405154456199.png)

åœ¨å¯¼å‡ºé¡µé¢ä¸­ï¼Œå¡«å†™å„ä¸ªæ ‡ç­¾ï¼Œä¸€ä¸ªæ ‡ç­¾ä¸­çš„ä¸åŒæ¡ç›®å¯ä»¥ä½¿ç”¨è‹±æ–‡å­—ç¬¦ä¸­çš„ `,/&` ä¸‰ç§å­—ç¬¦è¿›è¡Œåˆ†å‰²

![image-20250405154815157](./img/README/image-20250405154815157.png)

> **å…³äº Github ID å’Œ Github ç”¨æˆ·å**
>
> å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½è¾“å…¥ä¸€æ¬¡è¿™ä¸¤ä¸ªæ¡ç›®ï¼Œæ‰“å¼€ lua è„šæœ¬ï¼Œæœç´¢ `name = "ttmlAuthorGithubs"`ï¼Œåœ¨è¯¥å¯¹è±¡çš„æœ€åæ·»åŠ ä¸€è¡Œ `value='id'`ï¼Œ`name = "ttmlAuthorGithubLogins"` æœç´¢ååŒç†
>
> ![image-20250405155148483](./img/README/image-20250405155148483.png)

> **å…³äº `offset`**
>
> å¦‚æœä½ åœ¨ä½¿ç”¨ CD æå–çš„éŸ³é¢‘è¿›è¡Œæ‰“è½´ï¼Œé‚£ä¹ˆéœ€è¦æå‰ä¸å¹³å°éŸ³æºæ¯”å¯¹è¿›è¡Œä¸€æ¬¡åç§»æ ¡å‡†
>
> ![image-20250405155825075](./img/README/image-20250405155825075.png)
>
> ![image-20250405160201781](./img/README/image-20250405160201781.png)
>
> ![image-20250405160236100](./img/README/image-20250405160236100.png)
>
> ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¾—çŸ¥å¹³å°éŸ³æºç›¸æ¯”äº CD éŸ³æºå‰é¢å¤šäº† 123 ms çš„ç©ºç™½éŸ³é¢‘ï¼Œå› æ­¤ offset ä¸º +123 ms
>
> ![image-20250405160333347](./img/README/image-20250405160333347.png)
>
> å¦‚æœä¸æƒ³æ¯æ¬¡å¯¼å‡ºæ—¶éƒ½å¡«å†™ï¼Œå¯ä»¥æ‰“å¼€ã€Œè„šæœ¬é…ç½®ã€ï¼Œå°†ã€Œæ›´æ–°æ‘˜è¦ã€è®¾å®šä¸º `+123ms`ï¼Œ**è¯¥ ass å­—å¹•**æ¯æ¬¡å¯¼å‡ºæ—¶éƒ½å°†è‡ªåŠ¨è®¾ç½® offset
>
> ![image-20250405160430068](./img/README/image-20250405160430068.png)

##### é€‰æ‹©ä¼˜åŒ–

![image-20250728224744588](./img/README/image-20250728224744588.png)

å…¶ä¸­

- ã€Œç©ºæ ¼å¤„ç†ã€æœ‰ã€Œä¸å¤„ç†ã€ã€ã€Œåˆå¹¶ã€ã€ã€Œæ‹†åˆ†ã€ä¸‰ç§é€‰é¡¹ï¼Œã€Œåˆå¹¶ã€é€‰é¡¹ä¼šå°†ç©ºæ ¼åˆå¹¶åˆ°å‰ä¸€ä¸ªéŸ³èŠ‚çš„æœ«å°¾ï¼Œã€Œæ‹†åˆ†ã€é€‰é¡¹åˆ™ä¼šå°†éŸ³èŠ‚å†…éƒ¨é¦–/å°¾çš„ç©ºæ ¼æ”¾åœ¨éŸ³èŠ‚å‰/åã€‚
- ã€Œåˆå¹¶å•ä¸ªæ ‡ç‚¹ã€æ‰“å¼€æ—¶ä¼šå°†å•ä¸ªæ ‡ç‚¹ç¬¦å·åˆå¹¶åˆ°å‰ä¸€ä¸ªéŸ³èŠ‚ä¸­ã€‚ï¼ˆ*å¦‚æœæ˜¯æˆå¯¹ç¬¦å·çš„å‰ä¸ªåˆ™ä¼šå‘ååˆå¹¶*ï¼‰
- ã€Œä¼˜åŒ– TTML ç»“æ„ã€æ‰“å¼€æ—¶ä¼šå°†ä»¥ä¸‹ä¸¤ç§éŸ³èŠ‚è½¬æ¢ä¸ºçº¯æ–‡æœ¬èŠ‚ç‚¹ï¼š
  - çº¯ç©ºæ ¼ç»„æˆçš„éŸ³èŠ‚
  - æŒç»­æ—¶é—´ä¸º 0 çš„éŸ³èŠ‚

##### è½¬æ¢å®Œæˆ

è½¬æ¢å®Œæˆåï¼Œå°†æ˜¾ç¤ºå¦‚ä¸‹ç•Œé¢

![image-20250405160614239](./img/README/image-20250405160614239.png)

<kbd>Copy</kbd> æŒ‰é’®å°†ç›´æ¥å¤åˆ¶ ttml æ–‡ä»¶å†…å®¹åˆ°å‰ªè´´æ¿ï¼Œå…¶ä¸­ <kbd>Save</kbd> æŒ‰é’®ä¼šå°† ttml å†…å®¹ä¿å­˜ä¸ºä¸€ä¸ª .ttml æ–‡ä»¶ã€‚å¦‚æœå¸Œæœ›é¢„è®¾ä¸€ä¸ªæ–‡ä»¶åï¼Œå¯ä»¥åœ¨ã€Œè„šæœ¬é…ç½®ã€ä¸­è®¾ç½®æ ‡é¢˜ï¼Œæ ‡é¢˜å°†ä½œä¸ºå¯¼å‡ºæ–‡ä»¶æ—¶çš„é»˜è®¤æ–‡ä»¶åã€‚

![image-20250405160904390](./img/README/image-20250405160904390.png)

### é™„â…  å…³äº furi åŠ karaoke templater

åœ¨å¯¹æ—¥è¯­æ­Œæ‰“è½´æ—¶éœ€è¦è¿›è¡Œå‡åæ ‡è®°ï¼Œå¹¶ä¸”ä¼šç”¨åˆ° karaoke æ¨¡æ¿å¤„ç†è¿›è¡Œé¢„è§ˆ

```plaintext
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,pre_end_time=0; pre_pos=0;
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code line,if (line.start_time)-200 < (pre_end_time)+800 then line.pos=1-pre_pos; else line.pos=0; end; pre_end_time=line.end_time; pre_pos=line.pos; if line.pos == 1 then line.top = line.top - line.height*1.65; line.bottom = line.bottom - line.height*1.65; end;
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,template furi noblank,!retime("line", -800, 200)!{\pos(!line.left+syl.center!,!line.top-200!)\k!($sstart/10)+80!\kf!($skdur)!\fad(200,200)}
Comment: 1,0:00:00.00,0:00:00.00,orig,,0,0,0,template syl noblank,!retime("line", -800, 200)!{\pos(!line.left+syl.center!,!line.bottom-200!)\k!($sstart/10)+80!\kf!($skdur)!\fad(200,200)}
Comment: 0,0:00:00.00,0:00:00.00,roma,,0,0,0,template line,!retime("line", -800, 200)!{\fad(200,200)}
Comment: 0,0:00:00.00,0:00:00.00,ts,,0,0,0,template line,!retime("line", -800, 200)!{\fad(200,200)}
Comment: 0,0:00:30.02,0:00:33.24,orig,L__1,0,0,0,karaoke,{\ko36}è¦‹|<ã¿{\ko32}ã¤{\ko26}ã‚{\ko25}ã‚‰{\ko10}ã‚Œ{\ko11}{\ko23}ãŸ{\ko11}ã‚‰ {\ko35}ã{\ko12}ã‚Œ{\ko11}{\ko21}ã {\ko26}ã‘{\ko43}ã§
Comment: 0,0:00:30.02,0:00:33.24,roma,____,0,0,0,karaoke,mi tsu me ra re ta ra so re da ke de
Comment: 0,0:00:30.02,0:00:33.24,ts,____,0,0,0,karaoke,çœ¸æ³¢æµè½¬å¤„
Comment: 0,0:00:30.02,0:00:33.24,tuck,____,0,0,0,,{\kf47}è¦‹{\kf22}ã¤{\kf29}ã‚{\kf28}ã‚‰{\kf16}ã‚Œ{\kf30}ãŸ{\kf12}ã‚‰ {\kf34}ã{\kf17}ã‚Œ{\kf26}ã {\kf24}ã‘{\kf48}ã§
Comment: 0,0:00:33.72,0:00:36.83,orig,L__2,0,0,0,karaoke,{\ko45}ç”˜|<ã‚{\ko24}#|ã¾{\ko17}ã„{\ko50}èŠ±|<ã¯{\ko24}#|ãª{\ko11}ãŒ{\ko12} {\ko23}é¦™|<ã‹{\ko22}#|ãŠ{\ko25}ã‚Š{\ko7}ã {\ko51}ã™
Comment: 0,0:00:33.72,0:00:36.83,roma,____,0,0,0,karaoke,a ma i ha na ga ka o ri da su
Comment: 0,0:00:33.72,0:00:36.83,ts,____,0,0,0,karaoke,æ¡ƒå¤­ç¼ç¼æš—é¦™æµ®
Comment: 0,0:00:33.72,0:00:36.83,tuck,____,0,0,0,,{\kf73}ç”˜{\kf18}ã„{\kf71}èŠ±{\kf18}ãŒ {\kf48}é¦™{\kf29}ã‚Š{\kf10}ã {\kf35}ã™
```

è¯¥è„šæœ¬åœ¨å¯¼å‡ºæ—¶ï¼Œåªä¼šå¯¼å‡º `orig` ä¸­è¢«å¤„ç†åçš„å†…å®¹ï¼Œæ¯”å¦‚ `{\ko45}ç”˜|<ã‚{\ko24}#|ã¾{\ko17}ã„` å¯¼å‡ºåä¼šå˜ä¸ºä»¥ä¸‹å†…å®¹ï¼š

```plaintext
<span begin="00:33.843" end="00:34.533">ç”˜</span>
<span begin="00:34.533" end="00:34.703">ã„</span>
```

è€Œå¯¹äº karaoke templater å¤„ç†åçš„è¡Œã€‚ä¾‹å¦‚ï¼š

```plaintext
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(546.09375,658.8)\k80\kf69\fad(200,200)}ç”˜
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(659.46875,658.8)\k149\kf17\fad(200,200)}ã„
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(772.84375,658.8)\k166\kf74\fad(200,200)}èŠ±
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(886.21875,658.8)\k240\kf11\fad(200,200)}ãŒ
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(1033.78125,658.8)\k263\kf45\fad(200,200)}é¦™
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(1147.15625,658.8)\k308\kf25\fad(200,200)}ã‚Š
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(1260.53125,658.8)\k333\kf7\fad(200,200)}ã 
Dialogue: 1,0:00:32.92,0:00:37.03,orig,L__2,0,0,0,fx,{\pos(1373.90625,658.8)\k340\kf51\fad(200,200)}ã™
Dialogue: 0,0:00:32.92,0:00:37.03,orig-furigana,L__2,0,0,0,fx,{\pos(518.0390625,530.8)\k80\kf45\fad(200,200)}ã‚
Dialogue: 0,0:00:32.92,0:00:37.03,orig-furigana,L__2,0,0,0,fx,{\pos(574.1484375,530.8)\k125\kf24\fad(200,200)}ã¾
Dialogue: 0,0:00:32.92,0:00:37.03,orig-furigana,L__2,0,0,0,fx,{\pos(744.7890625,530.8)\k166\kf50\fad(200,200)}ã¯
Dialogue: 0,0:00:32.92,0:00:37.03,orig-furigana,L__2,0,0,0,fx,{\pos(800.8984375,530.8)\k216\kf24\fad(200,200)}ãª
Dialogue: 0,0:00:32.92,0:00:37.03,orig-furigana,L__2,0,0,0,fx,{\pos(1005.7265625,530.8)\k263\kf23\fad(200,200)}ã‹
Dialogue: 0,0:00:32.92,0:00:37.03,orig-furigana,L__2,0,0,0,fx,{\pos(1061.8359375,530.8)\k286\kf22\fad(200,200)}ãŠ
Dialogue: 0,0:00:32.92,0:00:37.03,roma,____,0,0,0,fx,{\fad(200,200)}a ma i ha na ga ka o ri da su
Dialogue: 0,0:00:32.92,0:00:37.03,ts,____,0,0,0,fx,{\fad(200,200)}æ¡ƒå¤­ç¼ç¼æš—é¦™æµ®
```

ç”±äºã€Œç‰¹æ•ˆã€åˆ—ä¸º `fx`ï¼Œå› æ­¤ä¸å¿…æ‹…å¿ƒå½±å“å¯¼å‡ºå†…å®¹

### é™„â…¡ å…¶å®ƒ Aegisub æ’ä»¶å’Œæ¨¡æ¿

- [![check.ass](https://img.shields.io/badge/template-check.ass-c21f30)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/check.ass)ï¼šæ—¶é—´è½´æ ¸æŸ¥æ¨¡æ¿
- [![add-num.lua](https://img.shields.io/badge/automation-add_num.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/add-num.lua)ï¼šæ ‡è®°è¡Œå·è„šæœ¬
- [![add-trans.lua](https://img.shields.io/badge/automation-add_trans.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/add-trans.lua)ï¼šå¿«é€Ÿæ·»åŠ ç¿»è¯‘è„šæœ¬
- [![fix-furi.lua](https://img.shields.io/badge/automation-fix_furi.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/fix-furi.lua)ï¼šä¿®å¤æ–­å¼€æ ‡æ³¨è„šæœ¬
- [![original-copy.lua](https://img.shields.io/badge/automation-original_copy.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/original-copy.lua)ï¼šå¤åˆ¶åŸæ–‡è„šæœ¬
- [![pure-amll.lua](https://img.shields.io/badge/automation-pure_amll.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/pure-amll.lua)ï¼šttml åŸæ ·å¯¼å‡ºè„šæœ¬
- [![replace-rows.lua](https://img.shields.io/badge/automation-replace_rows.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/replace-rows.lua)ï¼šæ›¿æ¢è¡Œå†…å®¹è„šæœ¬
- [![reset-line.lua](https://img.shields.io/badge/automation-reset_line.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/reset-line.lua)ï¼šæ¸…é™¤ fx è¡Œå¹¶å–æ¶ˆæ³¨é‡Šè„šæœ¬
- [![set-part.lua](https://img.shields.io/badge/automation-set_part.lua-000080)](https://github.com/ranhengzhang/amll-ttml-db-raw-data/blob/main/aegisub/set-part.lua)ï¼šé¢„è®¾ songPart è®¾ç½®è„šæœ¬