[Script Info]
; Script generated by Aegisub 3.2.2
; http://www.aegisub.org/
Title: Default Aegisub file
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
YCbCr Matrix: None

[Aegisub Project Garbage]
Last Style Storage: Default
Active Line: 7

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: orig,阿里巴巴普惠体 3.0 65 Medium,128,&H00D9CA8B,&H00A77F44,&H00FFFFFF,&H00000000,0,0,0,0,100,100,0,0,1,6.5,0,2,10,10,10,1
Style: roma,Raleway-v4020 ExtraBold,52,&H00D9CA8B,&H00A77F44,&H00FFFFFF,&H00000000,0,0,0,0,100,100,0,0,1,5,0,2,10,10,10,0
Style: ts,HarmonyOS Sans SC Medium,94,&H00D9CA8B,&H00A77F44,&H00FFFFFF,&H00000000,0,0,0,0,100,100,0,0,1,6.5,0,8,10,10,10,1
Style: default,Sarasa Gothic SC,64,&H00FFFFFF,&H000000FF,&H00000000,&H00000000,0,0,0,0,100,100,0,0,1,2,2,2,10,10,10,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,person = true;
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,author = '68000793';
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,artists = {}; album = ''; track='';
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,ncmMusicId = ''; qqMusicId = ''; spotifyId= ''; appleMusicId = ''; isrc = '';
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,ttml = ''; Li = 0; body = {start_time=0,end_time=0};
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,function getL() Li = Li + 1; return Li; end;
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code once,function artist() member = ''; for i = 1, #artists do member = member .. '<amll:meta key="artists" value="' .. artists[i] .. '"/>'; end; return member; end;
Comment: 0,0:00:00.00,0:00:00.00,meta,,0,0,0,code once,function split(str) local resultStrList = {}; str:gsub('[^/]+', function(w) artists[#artists + 1] = w; end); return resultStrList; end;
Comment: 0,0:00:00.00,0:00:00.00,meta,,0,0,0,code line,if line.actor == 'ncm' then ncmMusicId = line.text; elseif line.actor == 'qq' then qqMusicId = line.text; elseif line.actor == 'spotify' then spotifyId = line.text; elseif line.actor == 'apple' then appleMusicId = line.text; elseif line.actor == 'isrc' then isrc = line.text; end;
Comment: 0,0:00:00.00,0:00:00.00,meta,,0,0,0,code line,if line.actor == 'artists' then artists = {}; split(line.text); elseif line.actor == 'album' then album = line.text; elseif line.actor == 'track' then track = line.text; end;
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code line,if line.actor:find('x-bg') ~= nil then ttml = string.sub(ttml, 0, -5) end; if line.actor:find('x-anti') ~= nil then person = false; end; ttml = ttml .. string.format('<%s begin="%02d:%02d.%03d" end="%02d:%02d.%03d" %s %s>', line.actor:find('x-bg') ~= nil and 'span ttm:role="x-bg"' or 'p', math.floor(line.start_time/60000), math.floor(line.start_time/1000)%60, line.start_time%1000, math.floor(line.end_time/60000), math.floor(line.end_time/1000)%60, line.end_time%1000, line.actor:find('x-bg') ~= nil and '' or string.format('ttm:agent="%s"', line.actor:find('x-anti') == nil and 'v1' or 'v2'), line.actor:find('x-bg') ~= nil and '' or string.format('itunes:key="L%d"', getL())); if Li == 1 then body.start_time = line.start_time; end; body.end_time = line.end_time;
Comment: 0,0:00:00.00,0:00:00.00,orig,,0,0,0,code syl,syl.text = syl.text:gsub('%s+', ' '); if (syl.duration == 0 and syl.text:match('^%s+$') == nil) then syl.end_time = syl.end_time + 3; end; if (syl.i > 0 and syl.text ~= '') then ttml = ttml .. string.format( '<span begin="%02d:%02d.%03d" end="%02d:%02d.%03d">', math.floor((syl.start_time + line.start_time) / 60000), math.floor((syl.start_time + line.start_time) / 1000) % 60, (syl.start_time + line.start_time) % 1000, math.floor((syl.end_time + line.start_time) / 60000), math.floor((syl.end_time + line.start_time) / 1000) % 60, (syl.end_time + line.start_time) % 1000); if line.actor:find('x-bg') ~= nil and syl.i == 1 then ttml = ttml .. '(' .. syl.text; elseif line.actor:find('x-bg') ~= nil and syl.i == line.kara.n then ttml = ttml .. syl.text .. ')'; else ttml = ttml .. syl.text; end; ttml = ttml .. '</span>'; if syl.i == line.kara.n then if line.actor:find('x-bg') ~= nil then ttml = ttml .. '</span>'; end; ttml = ttml .. '</p>'; end; end;
Comment: 0,0:00:00.00,0:00:00.00,roma,,0,0,0,code line,ttml = ttml:sub(0, line.actor:find('x-bg') ~= nil and -12 or -5) .. string.format('<span ttm:role="x-roman">%s</span>%s', line.text, line.actor:find('x-bg') ~= nil and '</span></p>' or '</p>');
Comment: 0,0:00:00.00,0:00:00.00,ts,,0,0,0,code line,ttml = ttml:sub(0, line.actor:find('x-bg') ~= nil and -12 or -5) .. string.format('<span ttm:role="x-translation" xml:lang="zh-CN">%s</span>%s', line.text, line.actor:find('x-bg') ~= nil and '</span></p>' or '</p>');
Comment: 0,0:00:00.00,0:00:00.00,ttml,,0,0,0,template line notext,<tt xmlns="http://www.w3.org/ns/ttml" xmlns:ttm="http://www.w3.org/ns/ttml#metadata" xmlns:amll="http://www.example.com/ns/amll" xmlns:itunes="http://music.apple.com/lyric-ttml-internal"><head><metadata><ttm:agent type="person" xml:id="v1"/>!person and '' or '<ttm:agent type="other" xml:id="v2"/>'!!ncmMusicId == '' and '' or ('<amll:meta key="ncmMusicId" value="' .. ncmMusicId .. '"/>')!!qqMusicId == '' and '' or ('<amll:meta key="qqMusicId" value="' .. qqMusicId .. '"/>')!!spotifyId == '' and '' or ('<amll:meta key="spotifyId" value="' .. spotifyId .. '"/>')!!appleMusicId == '' and '' or ('<amll:meta key="appleMusicId" value="' .. appleMusicId .. '"/>')!!isrc == '' and '' or ('<amll:meta key="isrc" value="' .. isrc .. '"/>')!<amll:meta key="musicName" value="!track!"/>!artist()!<amll:meta key="album" value="!album!"/><amll:meta key="ttmlAuthorGithub" value="!author!"/></metadata></head>!string.format('<body dur="%02d:%02d.%03d">', math.floor(body.end_time/60000), math.floor(body.end_time/1000)%60, body.end_time%1000)!!string.format('<div begin="%02d:%02d.%03d" end="%02d:%02d.%03d">', math.floor(body.start_time/60000), math.floor(body.start_time/1000)%60, body.start_time%1000, math.floor(body.end_time/60000), math.floor(body.end_time/1000)%60, body.end_time%1000)!!ttml!</div></body></tt>
Comment: 0,0:00:00.00,0:00:00.00,ttml,,0,0,0,karaoke,粘贴在这一行之前【注意】样式为[orig[, roma[, ts]]]的组顺序循环排列，背景和声以组为单位紧跟在原文组后。背景和声行在说话人中加上`x-bg`，对唱行在说话人中加上`x-anti`。
Dialogue: 0,0:00:00.00,0:00:00.00,ttml,,0,0,0,fx,<tt xmlns="http://www.w3.org/ns/ttml" xmlns:ttm="http://www.w3.org/ns/ttml#metadata" xmlns:amll="http://www.example.com/ns/amll" xmlns:itunes="http://music.apple.com/lyric-ttml-internal"><head><metadata><ttm:agent type="person" xml:id="v1"/><ttm:agent type="other" xml:id="v2"/><amll:meta key="musicName" value=""/><amll:meta key="album" value=""/><amll:meta key="ttmlAuthorGithub" value="68000793"/></metadata></head><body dur="00:09.000"><div begin="00:00.000" end="00:09.000"><p begin="00:00.000" end="00:03.000" ttm:agent="v1" itunes:key="L1"><span begin="00:00.000" end="00:01.000">AA</span><span begin="00:01.000" end="00:03.000">AA</span><span ttm:role="x-roman">aaaa</span><span ttm:role="x-translation" xml:lang="zh-CN">āáǎà</span></p><p begin="00:03.000" end="00:06.000" ttm:agent="v2" itunes:key="L2"><span begin="00:03.000" end="00:04.000">EE</span><span begin="00:04.000" end="00:06.000">EE</span><span ttm:role="x-roman">eeee</span><span ttm:role="x-translation" xml:lang="zh-CN">ēéěè</span><span ttm:role="x-bg" begin="00:03.000" end="00:06.000"  ><span begin="00:03.000" end="00:04.000">(II</span><span begin="00:04.000" end="00:06.000">II)</span><span ttm:role="x-roman">iiii</span><span ttm:role="x-translation" xml:lang="zh-CN">īíǐì</span></span></p><p begin="00:06.000" end="00:09.000" ttm:agent="v1" itunes:key="L3"><span begin="00:06.000" end="00:07.000">OO</span><span begin="00:07.000" end="00:09.000">OO</span><span ttm:role="x-roman">oooo</span><span ttm:role="x-translation" xml:lang="zh-CN">ōóǒò</span><span ttm:role="x-bg" begin="00:06.000" end="00:09.000"  ><span begin="00:06.000" end="00:07.000">(UU</span><span begin="00:07.000" end="00:09.000">UU)</span><span ttm:role="x-roman">uuuu</span><span ttm:role="x-translation" xml:lang="zh-CN">ūúŭù</span></span></p></div></body></tt>